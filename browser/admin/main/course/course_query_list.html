<div id="top" style="width: 98%;">
	<form class="layui-form" id="course_query_form" lay-filter="course_query_form">
		<div class="layui-row body-head-in">
			<div class="layui-col-md-offset3">
				<div class="layui-col-lg4">
					<div class="layui-inline">
						<div class="layui-input-inline">
							<select name="course_cat" id="course_cat" lay-filter="course_cat">
								<option value="免费试听课">免费试听课</option>
								<option value="正式精品课" selected>正式精品课</option>

							</select>
						</div>
					</div>	
				</div>
				<div class="layui-col-lg1"></div>
				<div class="layui-col-lg4">
					<div class="layui-inline">
						<div class="layui-input-inline">
							<select name="branch_sel" id="branch_sel" lay-filter="branch_sel">
								<option value="0" selected>所有分部</option>
								<option value="实训中心">实训中心</option>
								<option value="艺术中心">艺术中心</option>
								<option value="恒大名都">恒大名都</option>
							</select>
						</div>
					</div>
				</div>
				<div class="layui-col-lg3" align="center">
					<h4 style="margin-top: 20px;"><a href="#22" class="lz-font-color-blue">+添加课程</a></h4>
				</div>
			</div>
		</div>
	</form>
	<div class="body-in" style="width: 95%; margin-top: 1px;">
		<table class="layui-hide" id="course_list" lay-filter="course_list" lay-data="{id: 'imgs_col'}"></table>
	</div>
</div>

<script>
	var course_cat = '',
			branch_sel = '';
	//JavaScript代码区域
	layui.use('element', function() {
		var element = layui.element;
	});
</script>
<script>
	var count = 0;

	function afterload() {
		//		console.log("loading ... count = " + count);
		//		for(var i = 0; i < count; i++) {
		var id_img = count + '_img';
		console.log("loading ... i = " + count + " " + id_img);
		layui.use('layer', function() {
			var layer = layui.layer;
			layer.photos({
				photos: '#' + id_img,
				anim: 5 //0-6的选择，指定弹出图片动画类型，默认随机（请注意，3.0之前的版本用shift参数）
			});
			console.log("layer.photos(): " + id_img);
		});
	};
</script>

<script id="barDemo" type="text/html">
	<a class="layui-btn layui-btn-primary layui-btn-xs" lay-event="detail">查看</a>
	<a class="layui-btn layui-btn-xs" lay-event="edit">编辑</a>
	<a class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">删除</a>
</script>
<script id="imgTpl" type="text/html">
	<div id="{{d.LAY_INDEX}}_img"><img src="{{ d.courseimg }}"></div>
	{{# count ++; console.log("count = " + count); afterload(); }}
</script>
<script>
	layui.use('table', function() {
		var table = layui.table;
		//监听工具条
		table.on('tool(course_list)', function(obj) {
			var data = obj.data;
			if(obj.event === 'detail') {													//这里根据类型不同跳转到不同的页，传一下id
				if(course_cat == "免费试听课") {
					
				} else if(course_cat == "正式精品课")  {
					
				}
			} else if(obj.event === 'del') {
				layer.confirm('真的删除行么', function(index) {
					obj.del();
					layer.close(index);
				});
			} else if(obj.event === 'edit') {
				//						layer.msg('编辑行：<br>' + JSON.stringify(data)) //在这里跳入编辑界面
				if(data.courseprice == "-") {
					window.location.href = "#23";
				} else {
					window.location.href = "#24";
				}
			}
		});
	});
	//	$(function() {
	//		//				$("img").click(function(){
	//		//					var _this = $(this);//将当前的pimg元素作为_this传入函数
	//		//					imgShow("#outerdiv", "#innerdiv", "#bigimg", _this);
	//		//				});
	//		layui.use('layer', function() {
	//			var layer = layui.layer;
	////			// 	layer.msg("hhh");
	//			layer.photos({
	//				photos: '.layui-table-hover',
	////				photos: '#img_course',
	//				anim: 2 //0-6的选择，指定弹出图片动画类型，默认随机（请注意，3.0之前的版本用shift参数）
	//			});
	////
	//		});
	//	});

	//		}
</script>
<script>
	layui.use(['form', 'table'], function() {
		var form = layui.form,
			table = layui.table;
		form.render();
		
		form.val('course_query_form', {
				'course_cat': "正式精品课"
			});
		course_cat = "正式精品课"
		
		table.render({
					elem: '#course_list',
					url: '../../json/course.json?', //TODO  全部课程
					dataType: 'jsonp',
					skin: 'nob',
					cellMinWidth: 80, //全局定义常规单元格的最小宽度，layui 2.2.1 新增
					id: 'table-content',
					cols: [
						[{
							field: 'courseid',
							width: '11%',
							title: '课程编号'

						}, {
							field: 'coursename',
							width: '21%',
							title: '课程名称'
						}, {
							width: '16%',
							field: 'courseimg',
							title: '课程图片',
							templet: '#imgTpl'

						}, {
							field: 'coursecategory',
							width: '11%',
							title: '课程类别'
						}, {
							field: 'branch',
							width: '11%',
							title: '所在分部'
						}, {
							
							align: 'center',
							toolbar: '#barDemo'
						}]
					],
					page: true
				});

		//监听课程类别
		form.on('select(course_cat)', function(data) {
			console.log(data.elem); //得到select原始DOM对象
			console.log(data.value); //得到被选中的值
			console.log(data.othis); //得到美化后的DOM对象
			course_cat = data.value == 0 ? '' : data.value;
			branch_sel = '';
			form.val('course_query_form', {
				'branch_sel': 0
			});
			if(course_cat == "免费试听课") {
				table.render({
					elem: '#course_list',
					url: '../../json/course.json?', //TODO
					dataType: 'jsonp',
					skin: 'nob',
					cellMinWidth: 80, //全局定义常规单元格的最小宽度，layui 2.2.1 新增
					id: 'table-content',
					cols: [
						[{
							field: 'courseid',
							width: '11%',
							title: '课程编号'

						}, {
							field: 'coursename',
							width: '21%',
							title: '课程名称'
						}, {
							width: '16%',
							field: 'courseimg',
							title: '课程图片',
							templet: '#imgTpl'

						}, {
							field: 'coursecategory',
							width: '11%',
							title: '课程类别'
						}, {
							field: 'branch',
							width: '11%',
							title: '所在分部'
						}, {
							
							align: 'center',
							toolbar: '#barDemo'
						}]
					],
					page: true
				});
			} else if(course_cat == "正式精品课") {
				table.render({
					elem: '#course_list',
					url: '../../json/course.json?', //TODO
					dataType: 'jsonp',
					skin: 'nob',
					cellMinWidth: 80, //全局定义常规单元格的最小宽度，layui 2.2.1 新增
					id: 'table-content',
					cols: [
						[{
							field: 'courseid',
							width: '11%',
							title: '课程编号'
						}, {
							field: 'coursename',
							width: '21%',
							title: '课程名称'
						}, {
							width: '16%',
							field: 'courseimg',
							title: '课程图片',
							templet: '#imgTpl'
						}, {
							field: 'courseprice',
							width: '11%',
							title: '课程价钱'
						}, {
							field: 'coursecategory',
							width: '11%',
							title: '课程类别'
						}, {
							
							align: 'center',
							toolbar: '#barDemo'
						}]
					],
					page: true
				});
			}

		});

		//监听分部选择
		form.on('select(branch_sel)', function(data) {
			console.log(data.elem); //得到select原始DOM对象
			console.log(data.value); //得到被选中的值
			console.log(data.othis); //得到美化后的DOM对象
			branch_sel = data.value == 0 ? '' : data.value;
			if(course_cat == "0") {
				form.val('course_query_form', {
				'course_cat': "正式精品课"
			});
			
			}
			if(course_cat == "免费试听课") {
				table.render({
					elem: '#course_list',
					url: '../../json/course.json?', //TODO
					dataType: 'jsonp',
					skin: 'nob',
					cellMinWidth: 80, //全局定义常规单元格的最小宽度，layui 2.2.1 新增
					id: 'table-content',
					cols: [
						[{
							field: 'courseid',
							width: '11%',
							title: '课程编号'

						}, {
							field: 'coursename',
							width: '21%',
							title: '课程名称'
						}, {
							width: '16%',
							field: 'courseimg',
							title: '课程图片',
							templet: '#imgTpl'

						}, {
							field: 'coursecategory',
							width: '11%',
							title: '课程类别'
						}, {
							field: 'branch',
							width: '11%',
							title: '所在分部'
						}, {
						
							align: 'center',
							toolbar: '#barDemo'
						}]
					],
					page: true
				});
			} else if(course_cat == "正式精品课") {
				table.render({
					elem: '#course_list',
					url: '../../json/course.json?', //TODO
					dataType: 'jsonp',
					skin: 'nob',
					cellMinWidth: 80, //全局定义常规单元格的最小宽度，layui 2.2.1 新增
					id: 'table-content',
					cols: [
						[{
							field: 'courseid',
							width: '11%',
							title: '课程编号'
						}, {
							field: 'coursename',
							width: '21%',
							title: '课程名称'
						}, {
							width: '16%',
							field: 'courseimg',
							title: '课程图片',
							templet: '#imgTpl'
						}, {
							field: 'courseprice',
							width: '11%',
							title: '课程价钱'
						}, {
							field: 'coursecategory',
							width: '11%',
							title: '课程类别'
						}, {
						
							align: 'center',
							toolbar: '#barDemo'
						}]
					],
					page: true
				});
			}

		});
	});
</script>